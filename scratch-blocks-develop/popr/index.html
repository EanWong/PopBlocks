<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>POP!</title>

    <script>
    	var live = (window.location.href.startsWith("http://")); // whether or not this is live or just on computer
	      
      function showAndroidToast(toast) {
        Android.showToast(toast);
      }
            
      function addRobot() {
      	Android.addRobot();
      }
      
      function populateNav() {
        var count;
      	if (live) {
      	  count = Android.numPrograms();
      	} else {
      	  count = 10; // 10;
      	}
      	var prog = document.getElementById("programs");
      				  	
      	for (let i=0; i<count; i++) {
      		var a = document.createElement('a');
			var img = document.createElement('img');
			img.src = "../media/piece" + (i%7+1) + ".svg";
			img.alt = "Prog " + (i+1);
			a.appendChild(img);
			a.href = "freespace.html#" + (i+1);
			a.className = "progLink";
			prog.appendChild(a);
      	}
      }
      
      function toggleWorkspaces() {
        var prog = document.getElementById("programs");
        if (prog.style.display == "intiial") {
          setTimeout(function(){
      	    prog.style.display = "none";
		  }, 100);
        } else {
	      setTimeout(function(){
	        prog.style.display = "initial";
		  }, 100);
        }
      }
      
      function loadWorkspace(number) {
        if (live) {
    	  var xml_text = Android.loadWorkspace(number);
      	  var xml = Blockly.Xml.textToDom(xml_text);
      	  Blockly.Xml.domToWorkspace(xml, workspace);
      	
	      var code = Blockly.Popr.workspaceToCode(workspace);
	      Android.saveRule(code);
	    } else {
	      console.log("Loading program " + number);
	    }
      }
    </script>
	<link rel="stylesheet" type="text/css" href="index.css"> 
  </head>

  <body onload="populateNav()">
  <div>
	<a href="tutorial.jpg" class="navLink"><img src="../media/book.svg" alt="Story Tutorial"></a>
    <a href="freespace.html" class="navLink"><img src="../media/new.svg" alt="New Workspace"></a>
	    <a href="#" onclick="toggleWorkspaces()" class="navLink"><img src="../media/open.svg" alt="Load Workspace">
			<div id="programs"></div>
	    </a>
    <a href="tega.html" class="navLink"><img src="../media/icons/tega_blue.svg" alt="New Workspace"></a>
  </div>
	
  </body>
</html>
